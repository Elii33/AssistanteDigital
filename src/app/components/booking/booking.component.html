<section
  id="booking"
  class="booking-section relative py-24 overflow-hidden"
  (mousemove)="onMouseMove($event)"
  (mouseenter)="onMouseEnter()"
  (mouseleave)="onMouseLeave()">

  <!-- Canvas pour les particules animées -->
  <canvas #particleCanvas class="absolute inset-0 pointer-events-none z-0"></canvas>

  <!-- Fond avec gradient mesh animé -->
  <div class="absolute inset-0 bg-gradient-to-br from-beige-50 via-white to-beige-100"></div>

  <!-- Effet de lumière qui suit la souris -->
  <div
    class="spotlight-effect absolute inset-0 pointer-events-none transition-opacity duration-300 z-10"
    [ngStyle]="getSpotlightStyle()">
  </div>

  <!-- Grille décorative subtile -->
  <div class="absolute inset-0 opacity-[0.03]"
       style="background-image: linear-gradient(#ca8a04 1px, transparent 1px), linear-gradient(90deg, #ca8a04 1px, transparent 1px); background-size: 60px 60px;">
  </div>

  <!-- Formes géométriques flottantes -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <!-- Cercle doré avec rotation -->
    <div class="absolute -top-20 -right-20 w-96 h-96 opacity-20">
      <div class="w-full h-full rounded-full border-2 border-gold-400 animate-spin-slow"></div>
      <div class="absolute inset-8 rounded-full border border-gold-300 animate-spin-reverse"></div>
      <div class="absolute inset-16 rounded-full border border-dashed border-gold-200 animate-spin-slow"></div>
    </div>

    <!-- Blob morphing -->
    <div class="floating-blob absolute -bottom-32 -left-32 w-[500px] h-[500px] bg-gradient-to-br from-gold-200/30 to-beige-300/30 rounded-full blur-3xl"></div>

    <!-- Lignes décoratives -->
    <svg class="absolute top-20 left-10 w-32 h-32 text-gold-300/30 animate-float" viewBox="0 0 100 100">
      <path d="M10,50 Q50,10 90,50 Q50,90 10,50" fill="none" stroke="currentColor" stroke-width="1"/>
    </svg>

    <!-- Étoiles/sparkles -->
    <div class="sparkle absolute top-1/4 right-1/4 w-2 h-2 bg-gold-400 rounded-full"></div>
    <div class="sparkle absolute top-1/3 left-1/3 w-1.5 h-1.5 bg-gold-500 rounded-full" style="animation-delay: 0.5s"></div>
    <div class="sparkle absolute bottom-1/4 right-1/3 w-2 h-2 bg-beige-400 rounded-full" style="animation-delay: 1s"></div>
  </div>

  <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-20">
    <!-- En-tête de section avec effet de texte -->
    <div class="text-center mb-20">
      <!-- Badge animé premium -->
      <div class="inline-flex items-center gap-3 px-6 py-3 mb-10 animate-fade-in-down">
        <div class="relative">
          <div class="absolute inset-0 bg-gradient-to-r from-gold-400 to-gold-600 rounded-full blur-md opacity-50 animate-pulse"></div>
          <div class="relative flex items-center gap-3 px-5 py-2.5 bg-white/90 backdrop-blur-xl rounded-full border border-gold-200/50 shadow-lg shadow-gold-500/10">
            <span class="relative flex h-3 w-3">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
            </span>
            <span class="text-sm font-semibold bg-gradient-to-r from-beige-800 to-gold-700 bg-clip-text text-transparent">
              Disponible pour de nouveaux projets
            </span>
          </div>
        </div>
      </div>

      <!-- Titre avec effet de révélation -->
      <div class="overflow-hidden">
        <h2 class="text-4xl md:text-5xl lg:text-6xl font-bold text-beige-900 mb-4 animate-slide-up-reveal">
          Réservez votre
        </h2>
      </div>
      <div class="overflow-hidden">
        <h2 class="text-4xl md:text-5xl lg:text-6xl font-bold animate-slide-up-reveal" style="animation-delay: 0.1s">
          <span class="relative inline-block">
            <span class="relative z-10 bg-gradient-to-r from-gold-500 via-gold-600 to-beige-700 bg-clip-text text-transparent">
              appel découverte
            </span>
            <!-- Soulignement animé -->
            <svg class="absolute -bottom-2 left-0 w-full h-3 text-gold-400" viewBox="0 0 200 12" preserveAspectRatio="none">
              <path class="underline-path" d="M0,9 Q50,0 100,9 T200,9" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </span>
        </h2>
      </div>

      <!-- Sous-titre -->
      <p class="mt-8 text-lg md:text-xl text-beige-600 max-w-2xl mx-auto leading-relaxed animate-fade-in" style="animation-delay: 0.3s">
        Un échange <span class="font-semibold text-gold-600 relative">
          gratuit de 30 minutes
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-gold-400 to-transparent"></span>
        </span> pour discuter de vos besoins et voir comment je peux vous accompagner.
      </p>
    </div>

    <!-- Carte Calendly Premium -->
    <div class="max-w-5xl mx-auto">
      <div class="relative group animate-scale-in" style="animation-delay: 0.4s">
        <!-- Glow effect multiple layers -->
        <div class="absolute -inset-1 bg-gradient-to-r from-gold-400 via-beige-400 to-gold-400 rounded-[2rem] opacity-0 group-hover:opacity-30 blur-xl transition-all duration-700"></div>
        <div class="absolute -inset-0.5 bg-gradient-to-r from-gold-500/20 to-beige-500/20 rounded-[2rem] opacity-0 group-hover:opacity-100 transition-all duration-500"></div>

        <!-- Carte principale avec glassmorphism -->
        <div class="card-glass relative bg-white/80 backdrop-blur-xl rounded-[2rem] shadow-2xl overflow-hidden border border-white/50 transition-all duration-500 group-hover:shadow-[0_30px_80px_-20px_rgba(202,138,4,0.3)] group-hover:-translate-y-1">

          <!-- Barre gradient animée en haut -->
          <div class="h-1.5 bg-gradient-to-r from-gold-400 via-gold-500 to-beige-500 background-animate"></div>

          <!-- Header élégant -->
          <div class="relative px-8 py-8 bg-gradient-to-br from-beige-50/80 to-white/80 border-b border-beige-100/50">
            <!-- Motif décoratif dans le header -->
            <div class="absolute top-0 right-0 w-64 h-64 opacity-5">
              <svg viewBox="0 0 200 200" class="w-full h-full">
                <defs>
                  <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                    <circle cx="10" cy="10" r="1" fill="#ca8a04"/>
                  </pattern>
                </defs>
                <rect width="200" height="200" fill="url(#grid)"/>
              </svg>
            </div>

            <div class="relative flex flex-col md:flex-row items-center justify-between gap-6">
              <div class="flex items-center gap-5">
                <!-- Icône avec effet de rotation au hover -->
                <div class="relative">
                  <div class="absolute inset-0 bg-gradient-to-br from-gold-400 to-gold-600 rounded-2xl blur-lg opacity-40 group-hover:opacity-60 transition-opacity"></div>
                  <div class="relative w-16 h-16 bg-gradient-to-br from-gold-400 to-gold-600 rounded-2xl flex items-center justify-center shadow-lg transform group-hover:rotate-6 group-hover:scale-110 transition-all duration-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                  </div>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-beige-900">Appel Découverte</h3>
                  <p class="text-beige-600 mt-1">Choisissez le créneau qui vous convient le mieux</p>
                </div>
              </div>

              <!-- Badges -->
              <div class="flex items-center gap-3">
                <span class="px-4 py-2 bg-gradient-to-r from-gold-100 to-gold-50 text-gold-700 rounded-xl font-semibold text-sm border border-gold-200/50 shadow-sm">
                  <span class="mr-1">⏱</span> 30 min
                </span>
                <span class="px-4 py-2 bg-gradient-to-r from-emerald-100 to-emerald-50 text-emerald-700 rounded-xl font-semibold text-sm border border-emerald-200/50 shadow-sm">
                  <span class="mr-1">✨</span> Gratuit
                </span>
              </div>
            </div>
          </div>

          <!-- Loader amélioré -->
          <div *ngIf="isLoading" class="flex flex-col items-center justify-center h-[550px] gap-6 bg-gradient-to-br from-white to-beige-50/50">
            <div class="relative">
              <!-- Cercles animés -->
              <div class="absolute inset-0 w-20 h-20 border-4 border-gold-100 rounded-full"></div>
              <div class="absolute inset-0 w-20 h-20 border-4 border-transparent border-t-gold-500 rounded-full animate-spin"></div>
              <div class="absolute inset-2 w-16 h-16 border-4 border-transparent border-t-gold-300 rounded-full animate-spin-reverse"></div>
              <!-- Centre -->
              <div class="w-20 h-20 flex items-center justify-center">
                <div class="w-3 h-3 bg-gold-500 rounded-full animate-pulse"></div>
              </div>
            </div>
            <div class="text-center">
              <p class="text-beige-700 font-medium text-lg">Chargement du calendrier</p>
              <p class="text-beige-500 text-sm mt-1">Merci de patienter...</p>
            </div>
          </div>

          <!-- Widget Calendly -->
          <div
            class="calendly-inline-widget"
            [attr.data-url]="calendlyUrl + '?hide_gdpr_banner=1&background_color=fefdfb&text_color=1c1917&primary_color=ca8a04'"
            style="min-width: 320px; height: 600px;"
            [class.hidden]="isLoading">
          </div>
        </div>
      </div>

      <!-- Bouton popup alternatif -->
      <div class="text-center mt-12 animate-fade-in" style="animation-delay: 0.6s">
        <div class="flex items-center justify-center gap-4 mb-6">
          <div class="h-px w-16 bg-gradient-to-r from-transparent via-beige-300 to-transparent"></div>
          <span class="text-beige-400 text-sm font-medium uppercase tracking-wider">ou</span>
          <div class="h-px w-16 bg-gradient-to-r from-transparent via-beige-300 to-transparent"></div>
        </div>

        <button
          (click)="openCalendlyPopup()"
          class="group relative inline-flex items-center gap-3 px-8 py-4 overflow-hidden rounded-2xl font-semibold text-white transition-all duration-300 hover:scale-105 active:scale-100">
          <!-- Background avec gradient animé -->
          <span class="absolute inset-0 bg-gradient-to-r from-gold-500 via-gold-600 to-beige-600 background-animate"></span>

          <!-- Effet de brillance -->
          <span class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500">
            <span class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></span>
          </span>

          <!-- Contenu -->
          <span class="relative flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform group-hover:rotate-12" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
            </svg>
            <span>Ouvrir en popup</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
          </span>
        </button>
      </div>
    </div>

    <!-- Cartes d'information avec effet holographique -->
    <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto mt-20">
      <!-- Carte 1 -->
      <div class="feature-card group relative animate-fade-in-up" style="animation-delay: 0.5s"
           (mousemove)="onCardMouseMove($event, 0)"
           (mouseleave)="onCardMouseLeave(0)"
           [style.transform]="cardTransforms[0]">
        <div class="absolute -inset-0.5 bg-gradient-to-r from-gold-400 to-gold-600 rounded-2xl opacity-0 group-hover:opacity-100 blur transition-all duration-500"></div>
        <div class="relative h-full p-8 bg-white rounded-2xl border border-beige-100 shadow-lg group-hover:shadow-2xl transition-all duration-500">
          <!-- Effet holographique -->
          <div class="holo-effect absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>

          <div class="relative z-10">
            <div class="w-16 h-16 mb-6 bg-gradient-to-br from-gold-400 to-gold-600 rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-110 group-hover:rotate-6 transition-all duration-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-beige-900 mb-3 group-hover:text-gold-600 transition-colors">30 minutes</h3>
            <p class="text-beige-600 leading-relaxed">Pour faire connaissance et comprendre vos besoins en profondeur</p>
          </div>
        </div>
      </div>

      <!-- Carte 2 -->
      <div class="feature-card group relative animate-fade-in-up" style="animation-delay: 0.6s"
           (mousemove)="onCardMouseMove($event, 1)"
           (mouseleave)="onCardMouseLeave(1)"
           [style.transform]="cardTransforms[1]">
        <div class="absolute -inset-0.5 bg-gradient-to-r from-beige-500 to-beige-700 rounded-2xl opacity-0 group-hover:opacity-100 blur transition-all duration-500"></div>
        <div class="relative h-full p-8 bg-white rounded-2xl border border-beige-100 shadow-lg group-hover:shadow-2xl transition-all duration-500">
          <div class="holo-effect absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>

          <div class="relative z-10">
            <div class="w-16 h-16 mb-6 bg-gradient-to-br from-beige-600 to-beige-800 rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-110 group-hover:-rotate-6 transition-all duration-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-beige-900 mb-3 group-hover:text-beige-700 transition-colors">Visio ou Téléphone</h3>
            <p class="text-beige-600 leading-relaxed">Choisissez le mode de communication qui vous convient le mieux</p>
          </div>
        </div>
      </div>

      <!-- Carte 3 -->
      <div class="feature-card group relative animate-fade-in-up" style="animation-delay: 0.7s"
           (mousemove)="onCardMouseMove($event, 2)"
           (mouseleave)="onCardMouseLeave(2)"
           [style.transform]="cardTransforms[2]">
        <div class="absolute -inset-0.5 bg-gradient-to-r from-emerald-400 to-emerald-600 rounded-2xl opacity-0 group-hover:opacity-100 blur transition-all duration-500"></div>
        <div class="relative h-full p-8 bg-white rounded-2xl border border-beige-100 shadow-lg group-hover:shadow-2xl transition-all duration-500">
          <div class="holo-effect absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>

          <div class="relative z-10">
            <div class="w-16 h-16 mb-6 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-110 group-hover:rotate-6 transition-all duration-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="text-xl font-bold text-beige-900 mb-3 group-hover:text-emerald-600 transition-colors">100% Gratuit</h3>
            <p class="text-beige-600 leading-relaxed">Sans aucun engagement, pour échanger en toute liberté</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Trust indicators premium -->
    <div class="mt-20 animate-fade-in" style="animation-delay: 0.8s">
      <div class="flex flex-wrap items-center justify-center gap-x-12 gap-y-6 py-8 px-6 bg-white/50 backdrop-blur-sm rounded-2xl border border-beige-100/50 shadow-sm max-w-4xl mx-auto">
        <div class="flex items-center gap-3 group cursor-default">
          <div class="w-10 h-10 bg-gradient-to-br from-emerald-100 to-emerald-50 rounded-xl flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-emerald-600" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
          </div>
          <span class="text-beige-700 font-medium">Confirmation instantanée</span>
        </div>

        <div class="flex items-center gap-3 group cursor-default">
          <div class="w-10 h-10 bg-gradient-to-br from-gold-100 to-gold-50 rounded-xl flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gold-600" viewBox="0 0 20 20" fill="currentColor">
              <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
              <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
            </svg>
          </div>
          <span class="text-beige-700 font-medium">Rappel automatique</span>
        </div>

        <div class="flex items-center gap-3 group cursor-default">
          <div class="w-10 h-10 bg-gradient-to-br from-beige-200 to-beige-100 rounded-xl flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-beige-700" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
            </svg>
          </div>
          <span class="text-beige-700 font-medium">Annulation flexible</span>
        </div>
      </div>
    </div>
  </div>
</section>
